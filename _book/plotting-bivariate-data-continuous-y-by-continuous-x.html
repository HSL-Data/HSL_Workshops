<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.5 Plotting bivariate data: continuous Y by continuous X | UVA Health Sciences Library Workshops</title>
  <meta name="description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="6.5 Plotting bivariate data: continuous Y by continuous X | UVA Health Sciences Library Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.5 Plotting bivariate data: continuous Y by continuous X | UVA Health Sciences Library Workshops" />
  
  <meta name="twitter:description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  

<meta name="author" content="Data Services @ HSL" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="about-ggplot2.html">
<link rel="next" href="plotting-bivariate-data-continuous-y-by-categorical-x.html">
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a></li>
<li class="chapter" data-level="2" data-path="about-the-instructors.html"><a href="about-the-instructors.html"><i class="fa fa-check"></i><b>2</b> About the Instructors</a></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>4</b> Introduction to R</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>4.1</b> Introduction to R and RStudio</a></li>
<li class="chapter" data-level="4.2" data-path="set-up-project-and-move-dataset.html"><a href="set-up-project-and-move-dataset.html"><i class="fa fa-check"></i><b>4.2</b> Set up Project and move dataset</a></li>
<li class="chapter" data-level="4.3" data-path="comments.html"><a href="comments.html"><i class="fa fa-check"></i><b>4.3</b> Comments</a></li>
<li class="chapter" data-level="4.4" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>4.4</b> Basic operations</a></li>
<li class="chapter" data-level="4.5" data-path="built-in-functions.html"><a href="built-in-functions.html"><i class="fa fa-check"></i><b>4.5</b> Built-in Functions</a></li>
<li class="chapter" data-level="4.6" data-path="nesting-functions.html"><a href="nesting-functions.html"><i class="fa fa-check"></i><b>4.6</b> Nesting Functions</a></li>
<li class="chapter" data-level="4.7" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>4.7</b> Vectors</a></li>
<li class="chapter" data-level="4.8" data-path="indexing-vectors.html"><a href="indexing-vectors.html"><i class="fa fa-check"></i><b>4.8</b> Indexing vectors</a></li>
<li class="chapter" data-level="4.9" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>4.9</b> Data Frames</a></li>
<li class="chapter" data-level="4.10" data-path="our-data.html"><a href="our-data.html"><i class="fa fa-check"></i><b>4.10</b> Our data</a></li>
<li class="chapter" data-level="4.11" data-path="inspecting-data-frames.html"><a href="inspecting-data-frames.html"><i class="fa fa-check"></i><b>4.11</b> Inspecting Data frames</a></li>
<li class="chapter" data-level="4.12" data-path="accessing-variables-subsetting-data-frames.html"><a href="accessing-variables-subsetting-data-frames.html"><i class="fa fa-check"></i><b>4.12</b> Accessing variables &amp; subsetting data frames</a></li>
<li class="chapter" data-level="4.13" data-path="filtering-a-data-frame.html"><a href="filtering-a-data-frame.html"><i class="fa fa-check"></i><b>4.13</b> Filtering a data frame</a></li>
<li class="chapter" data-level="4.14" data-path="base-plotting-histogram-and-scatterplot.html"><a href="base-plotting-histogram-and-scatterplot.html"><i class="fa fa-check"></i><b>4.14</b> Base plotting – histogram and scatterplot</a></li>
<li class="chapter" data-level="4.15" data-path="write-out-csv-file-of-filtered-dataframe.html"><a href="write-out-csv-file-of-filtered-dataframe.html"><i class="fa fa-check"></i><b>4.15</b> Write out csv file of filtered dataframe</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="taming-wild-data.html"><a href="taming-wild-data.html"><i class="fa fa-check"></i><b>5</b> Taming Wild Data</a><ul>
<li class="chapter" data-level="5.0.1" data-path="taming-wild-data.html"><a href="taming-wild-data.html#our-data-1"><i class="fa fa-check"></i><b>5.0.1</b> Our data</a></li>
<li class="chapter" data-level="5.0.2" data-path="taming-wild-data.html"><a href="taming-wild-data.html#set-up-project-download-data"><i class="fa fa-check"></i><b>5.0.2</b> Set up project &amp; Download data</a></li>
<li class="chapter" data-level="5.1" data-path="tibbles-v-dataframe.html"><a href="tibbles-v-dataframe.html"><i class="fa fa-check"></i><b>5.1</b> Tibbles v. dataframe</a></li>
<li class="chapter" data-level="5.2" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>5.2</b> The pipe: <strong>%&gt;%</strong></a></li>
<li class="chapter" data-level="5.3" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html"><i class="fa fa-check"></i><b>5.3</b> The dplyr package</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#filter"><i class="fa fa-check"></i><b>5.3.1</b> filter()</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#select"><i class="fa fa-check"></i><b>5.3.2</b> select()</a></li>
<li class="chapter" data-level="5.3.3" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#dplyr-in-action"><i class="fa fa-check"></i><b>5.3.3</b> dplyr in action</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>5.4</b> EXERCISE 1</a></li>
<li class="chapter" data-level="5.5" data-path="separate.html"><a href="separate.html"><i class="fa fa-check"></i><b>5.5</b> Separate</a></li>
<li class="chapter" data-level="5.6" data-path="resources-for-regular-expressions.html"><a href="resources-for-regular-expressions.html"><i class="fa fa-check"></i><b>5.6</b> Resources for Regular Expressions</a></li>
<li class="chapter" data-level="5.7" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>5.7</b> EXERCISE 2</a><ul>
<li class="chapter" data-level="5.7.1" data-path="exercise-2.html"><a href="exercise-2.html#merge-gene-ontologies"><i class="fa fa-check"></i><b>5.7.1</b> Merge Gene Ontologies</a></li>
<li class="chapter" data-level="5.7.2" data-path="exercise-2.html"><a href="exercise-2.html#fix-nutrient-names"><i class="fa fa-check"></i><b>5.7.2</b> Fix Nutrient names</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="break.html"><a href="break.html"><i class="fa fa-check"></i><b>5.8</b> Break</a></li>
<li class="chapter" data-level="5.9" data-path="more-fun-with-dplyr.html"><a href="more-fun-with-dplyr.html"><i class="fa fa-check"></i><b>5.9</b> More fun with dplyr</a></li>
<li class="chapter" data-level="5.10" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>5.10</b> EXERCISE 3</a><ul>
<li class="chapter" data-level="5.10.1" data-path="exercise-3.html"><a href="exercise-3.html#arrange"><i class="fa fa-check"></i><b>5.10.1</b> arrange()</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>5.11</b> EXERCISE 4</a><ul>
<li class="chapter" data-level="5.11.1" data-path="exercise-4.html"><a href="exercise-4.html#summarize"><i class="fa fa-check"></i><b>5.11.1</b> summarize()</a></li>
<li class="chapter" data-level="5.11.2" data-path="exercise-4.html"><a href="exercise-4.html#group_by"><i class="fa fa-check"></i><b>5.11.2</b> group_by()</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i><b>5.12</b> EXERCISE 5</a></li>
<li class="chapter" data-level="5.13" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i><b>5.13</b> EXERCISE 6</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="6.1" data-path="resources-to-learn-ggplot2.html"><a href="resources-to-learn-ggplot2.html"><i class="fa fa-check"></i><b>6.1</b> Resources to learn ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="make-sure-everyone-has-tidyverse-or-readr-dplyr-ggplot2.html"><a href="make-sure-everyone-has-tidyverse-or-readr-dplyr-ggplot2.html"><i class="fa fa-check"></i><b>6.2</b> Make sure everyone has tidyverse or readr, dplyr, ggplot2</a></li>
<li class="chapter" data-level="6.3" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html"><i class="fa fa-check"></i><b>6.3</b> Download data and make a new project</a><ul>
<li class="chapter" data-level="6.3.1" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html#gapminder-data"><i class="fa fa-check"></i><b>6.3.1</b> Gapminder data</a></li>
<li class="chapter" data-level="6.3.2" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html#dplyr-review"><i class="fa fa-check"></i><b>6.3.2</b> dplyr review</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="about-ggplot2.html"><a href="about-ggplot2.html"><i class="fa fa-check"></i><b>6.4</b> About ggplot2</a></li>
<li class="chapter" data-level="6.5" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html"><i class="fa fa-check"></i><b>6.5</b> Plotting bivariate data: continuous Y by continuous X</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#adding-layers"><i class="fa fa-check"></i><b>6.5.1</b> Adding layers</a></li>
<li class="chapter" data-level="6.5.2" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#faceting"><i class="fa fa-check"></i><b>6.5.2</b> Faceting</a></li>
<li class="chapter" data-level="6.5.3" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#saving-plots"><i class="fa fa-check"></i><b>6.5.3</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plotting-bivariate-data-continuous-y-by-categorical-x.html"><a href="plotting-bivariate-data-continuous-y-by-categorical-x.html"><i class="fa fa-check"></i><b>6.6</b> Plotting bivariate data: continuous Y by categorical X</a></li>
<li class="chapter" data-level="6.7" data-path="plotting-univariate-continuous-data.html"><a href="plotting-univariate-continuous-data.html"><i class="fa fa-check"></i><b>6.7</b> Plotting univariate continuous data</a></li>
<li class="chapter" data-level="6.8" data-path="publication-ready-plots-themes.html"><a href="publication-ready-plots-themes.html"><i class="fa fa-check"></i><b>6.8</b> Publication-ready plots &amp; themes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">UVA Health Sciences Library Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-bivariate-data-continuous-y-by-continuous-x" class="section level2">
<h2><span class="header-section-number">6.5</span> Plotting bivariate data: continuous Y by continuous X</h2>
<p>The <code>ggplot</code> function has two required arguments: the <em>data</em> used for creating the plot, and an <em>aesthetic</em> mapping to describe how variables in said data are mapped to things we can see on the plot.</p>
<p>First let’s load the package:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre>
<p>Now, let’s lay out the plot. If we want to plot a continuous Y variable by a continuous X variable we’re probably most interested in a scatter plot. Here, we’re telling ggplot that we want to use the <code>gm</code> dataset, and the aesthetic mapping will map <code>gdpPercap</code> onto the x-axis and <code>lifeExp</code> onto the y-axis. Remember that the variable names are case sensitive!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gm, <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp))</code></pre>
<p>When we do that we get a blank canvas with no data showing (you might get an error if you’re using an old version of ggplot2). That’s because all we’ve done is laid out a two-dimensional plot specifying what goes on the x and y axes, but we haven’t told it what kind of geometric object to plot. The obvious choice here is a point. Check out <a href="http://docs.ggplot2.org/">docs.ggplot2.org</a> to see what kind of geoms are available.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(gm, <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre>
<p>Here, we’ve built our plot in layers. First, we create a canvas for plotting layers to come using the <code>ggplot</code> function, specifying which <strong>data</strong> to use (here, the <strong>gm</strong> data frame), and an <strong>aesthetic mapping</strong> of <code>gdpPercap</code> to the x-axis and <code>lifeExp</code> to the y-axis. We next add a layer to the plot, specifying a <strong>geom</strong>, or a way of visually representing the aesthetic mapping.</p>
<p>Now, the typical workflow for building up a ggplot2 plot is to first construct the figure and save that to a variable (for example, <code>p</code>), and as you’re experimenting, you can continue to re-define the <code>p</code> object as you develop “keeper commands”.</p>
<p>First, let’s construct the graphic. Notice that we don’t have to specify <code>x=</code> and <code>y=</code> if we specify the arguments in the correct order (x is first, y is second).</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gm, <span class="kw">aes</span>(gdpPercap, lifeExp))
p</code></pre>
<p>The <code>p</code> object now contains the canvas, but nothing else. Try displaying it by just running <code>p</code>. Let’s experiment with adding points and a different scale to the x-axis.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Experiment with adding points</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()

<span class="co"># Experiment with a different scale</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>()</code></pre>
<p>I like the look of using a log scale for the x-axis. Let’s make that stick.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>()
p</code></pre>
<p>Now, if we re-ran <code>p</code> still nothing would show up because the <code>p</code> object just contains a blank canvas. Now, re-plot again with a layer of points:</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre>
<p>Now notice what I’ve saved to <code>p</code> at this point: only the basic plot layout and the log10 mapping on the x-axis. I didn’t save any layers yet because I want to fiddle around with the points for a bit first.</p>
<p>Above we implied the aesthetic mappings for the x- and y- axis should be <code>gdpPercap</code> and <code>lifeExp</code>, but we can also add aesthetic mappings to the geoms themselves. For instance, what if we wanted to color the points by the value of another variable in the dataset, say, continent?</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>continent))</code></pre>
<p>Notice the difference here. If I wanted the colors to be some static value, I wouldn’t wrap that in a call to <code>aes()</code>. I would just specify it outright. Same thing with other features of the points. For example, lets make all the points huge (<code>size=8</code>) blue (<code>color=&quot;blue&quot;</code>) semitransparent (<code>alpha=(1/4)</code>) triangles (<code>pch=17</code>):</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">17</span>, <span class="dt">size=</span><span class="dv">8</span>, <span class="dt">alpha=</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</code></pre>
<p>Now, this time, let’s map the aesthetics of the point character to certain features of the data. For instance, let’s give the points different colors and character shapes according to the continent, and map the size of the point onto the life Expectancy:</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>continent, <span class="dt">shape=</span>continent, <span class="dt">size=</span>lifeExp))</code></pre>
<p>Now, this isn’t a great plot because there are several aesthetic mappings that are redundant. Life expectancy is mapped to both the y-axis and the size of the points – the size mapping is superfluous. Similarly, continent is mapped to both the color and the point character (the shape is superfluous). Let’s get rid of that, but let’s make the points a little bigger outside of an aesthetic mapping.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>continent), <span class="dt">size=</span><span class="fl">1.5</span>)</code></pre>
<p><img src="Book_files/figure-html/scatter_colContinent_size4-1.png" width="672" /></p>
<hr />
<p><strong>EXERCISE 1</strong></p>
<p>Re-create this same plot from scratch without saving anything to a variable. That is, start from the <code>ggplot</code> call.</p>
<ul>
<li>Start with the <code>ggplot()</code> function.</li>
<li>Use the gm data.</li>
<li>Map <code>gdpPercap</code> to the x-axis and <code>lifeExp</code> to the y-axis.</li>
<li>Add points to the plot
<ul>
<li>Make the points size 3</li>
<li>Map continent onto the aesthetics of the point</li>
</ul></li>
<li>Use a log<sub>10</sub> scale for the x-axis.</li>
</ul>
<hr />
<div id="adding-layers" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Adding layers</h3>
<p>Let’s add a fitted curve to the points. Recreate the plot in the <code>p</code> object if you need to.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gm, <span class="kw">aes</span>(gdpPercap, lifeExp)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>()
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</code></pre>
<p><img src="Book_files/figure-html/scatter_addsmoothlayer-1.png" width="672" /></p>
<p>By default <code>geom_smooth()</code> will try to lowess (Locally Weighted Scatterplot Smoothing) for data with n&lt;1000 or GAM (Generalized Additive models) for data with n&gt;1000. (In the geom_smooth help menu you can read all about these)</p>
<p><code>geom_smooth()</code> using method = ‘gam’ and formula ‘y ~ s(x, bs = “cs”)’. The s = smoothing function. bs = basis of smoothing and cs = cubic regression spines with shrinkage</p>
<p>We can change the geom_smooth() behavior by tweaking the parameters to use a linear model instead of GAM</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre>
<p>Now tweak the parameters of the line to show a thick red line with no standard error stripes</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">se=</span><span class="ot">FALSE</span>, <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre>
<p>But let’s add back in our aesthetic mapping to the continents. Notice what happens here. We’re mapping continent as an aesthetic mapping <em>to the color of the points only</em> – so <code>geom_smooth()</code> still works only on the entire data.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> continent)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</code></pre>
<p>But notice what happens next: if we make the call to <code>aes()</code> <em>outside</em> of the <code>geom_point()</code> and <code>geom_smooth</code> calls, then the continent variable gets mapped as an aesthetic to all the following geoms. So here, we get separate smoothing lines for each continent.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> continent) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</code></pre>
<p><img src="Book_files/figure-html/scatter_final-1.png" width="672" /></p>
<p>Let’s do it again but remove the standard error stripes and make the lines a bit thicker.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">color =</span> continent) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre>
</div>
<div id="faceting" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Faceting</h3>
<p>Facets display subsets of the data in different panels. There are a couple ways to do this, but <code>facet_wrap()</code> tries to sensibly wrap a series of facets into a 2-dimensional grid of small multiples. Just give it a formula specifying which variables to facet by. We can continue adding more layers, such as smoothing. If you have a look at the help for <code>?facet_wrap()</code> you’ll see that we can control how the wrapping is laid out.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>continent)
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>continent, <span class="dt">ncol =</span> <span class="dv">1</span>)</code></pre>
<p><img src="Book_files/figure-html/scatter_facet1-1.png" width="480" /></p>
</div>
<div id="saving-plots" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Saving plots</h3>
<p>There are a few ways to save ggplots. The quickest way, that works in an interactive session, is to use the <code>ggsave()</code> function. You give it a file name and by default it saves the last plot that was printed to the screen.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
<span class="kw">ggsave</span>(<span class="dt">file=</span><span class="st">&quot;myplot.png&quot;</span>)</code></pre>
<p>But if you’re running this through a script, the best way to do it is to pass <code>ggsave()</code> the object containing the plot that is meant to be saved. We can also adjust things like the width, height, and resolution. <code>ggsave()</code> also recognizes the name of the file extension and saves the appropriate kind of file. Let’s save a PDF.</p>
<pre class="sourceCode r"><code class="sourceCode r">pfinal &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>continent, <span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">ggsave</span>(pfinal, <span class="dt">file=</span><span class="st">&quot;myplot.pdf&quot;</span>, <span class="dt">width=</span><span class="dv">5</span>, <span class="dt">height=</span><span class="dv">15</span>)</code></pre>
<hr />
<p><strong>EXERCISE 2</strong></p>
<ol style="list-style-type: decimal">
<li>Make a scatter plot of <code>lifeExp</code> on the y-axis against <code>year</code> on the x.</li>
<li>Make a series of small multiples faceting on continent.</li>
<li><p>Add a fitted curve, smooth or lm, with and without facets.</p></li>
<li><p><strong>Bonus</strong>: using <code>geom_line()</code> and an aesthetic mapping <code>country</code> to <code>group=</code>, make a “spaghetti plot”, showing <em>semitransparent</em> lines connected for each country, faceted by continent. Add a smoothed loess curve with a thick (<code>lwd=3</code>) line with no standard error stripe. Reduce the opacity (<code>alpha=</code>) of the individual black lines. <em>Don’t</em> show Oceania countries (that is, <code>filter()</code> the data where <code>continent!=&quot;Oceania&quot;</code> before you plot it).</p></li>
</ol>
<p><img src="Book_files/figure-html/spaghetti-1.png" width="768" /></p>
<hr />
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="about-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-bivariate-data-continuous-y-by-categorical-x.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
