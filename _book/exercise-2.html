<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.7 EXERCISE 2 | UVA Health Sciences Library Workshops</title>
  <meta name="description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="5.7 EXERCISE 2 | UVA Health Sciences Library Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.7 EXERCISE 2 | UVA Health Sciences Library Workshops" />
  
  <meta name="twitter:description" content="This site hosts workshop tutorials for researchers in the life sciences at the University of Virginia to learn R skills." />
  

<meta name="author" content="Data Services @ HSL" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="resources-for-regular-expressions.html">
<link rel="next" href="break.html">
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a></li>
<li class="chapter" data-level="2" data-path="about-the-instructors.html"><a href="about-the-instructors.html"><i class="fa fa-check"></i><b>2</b> About the Instructors</a><ul>
<li class="chapter" data-level="2.1" data-path="david-n-martin-ms.html"><a href="david-n-martin-ms.html"><i class="fa fa-check"></i><b>2.1</b> David N Martin, MS</a></li>
<li class="chapter" data-level="2.2" data-path="marieke-k-jones-phd.html"><a href="marieke-k-jones-phd.html"><i class="fa fa-check"></i><b>2.2</b> Marieke K Jones, PhD</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>4</b> Introduction to R</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>4.1</b> Introduction to R and RStudio</a></li>
<li class="chapter" data-level="4.2" data-path="set-up-project-and-move-dataset.html"><a href="set-up-project-and-move-dataset.html"><i class="fa fa-check"></i><b>4.2</b> Set up Project and move dataset</a></li>
<li class="chapter" data-level="4.3" data-path="comments.html"><a href="comments.html"><i class="fa fa-check"></i><b>4.3</b> Comments</a></li>
<li class="chapter" data-level="4.4" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>4.4</b> Basic operations</a></li>
<li class="chapter" data-level="4.5" data-path="built-in-functions.html"><a href="built-in-functions.html"><i class="fa fa-check"></i><b>4.5</b> Built-in Functions</a></li>
<li class="chapter" data-level="4.6" data-path="nesting-functions.html"><a href="nesting-functions.html"><i class="fa fa-check"></i><b>4.6</b> Nesting Functions</a></li>
<li class="chapter" data-level="4.7" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>4.7</b> Vectors</a></li>
<li class="chapter" data-level="4.8" data-path="indexing-vectors.html"><a href="indexing-vectors.html"><i class="fa fa-check"></i><b>4.8</b> Indexing vectors</a></li>
<li class="chapter" data-level="4.9" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>4.9</b> Data Frames</a></li>
<li class="chapter" data-level="4.10" data-path="our-data.html"><a href="our-data.html"><i class="fa fa-check"></i><b>4.10</b> Our data</a></li>
<li class="chapter" data-level="4.11" data-path="inspecting-data-frames.html"><a href="inspecting-data-frames.html"><i class="fa fa-check"></i><b>4.11</b> Inspecting Data frames</a></li>
<li class="chapter" data-level="4.12" data-path="accessing-variables-subsetting-data-frames.html"><a href="accessing-variables-subsetting-data-frames.html"><i class="fa fa-check"></i><b>4.12</b> Accessing variables &amp; subsetting data frames</a></li>
<li class="chapter" data-level="4.13" data-path="filtering-a-data-frame.html"><a href="filtering-a-data-frame.html"><i class="fa fa-check"></i><b>4.13</b> Filtering a data frame</a></li>
<li class="chapter" data-level="4.14" data-path="base-plotting-histogram-and-scatterplot.html"><a href="base-plotting-histogram-and-scatterplot.html"><i class="fa fa-check"></i><b>4.14</b> Base plotting – histogram and scatterplot</a></li>
<li class="chapter" data-level="4.15" data-path="write-out-csv-file-of-filtered-dataframe.html"><a href="write-out-csv-file-of-filtered-dataframe.html"><i class="fa fa-check"></i><b>4.15</b> Write out csv file of filtered dataframe</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="taming-wild-data.html"><a href="taming-wild-data.html"><i class="fa fa-check"></i><b>5</b> Taming Wild Data</a><ul>
<li class="chapter" data-level="5.0.1" data-path="taming-wild-data.html"><a href="taming-wild-data.html#our-data-1"><i class="fa fa-check"></i><b>5.0.1</b> Our data</a></li>
<li class="chapter" data-level="5.0.2" data-path="taming-wild-data.html"><a href="taming-wild-data.html#set-up-project-download-data"><i class="fa fa-check"></i><b>5.0.2</b> Set up project &amp; Download data</a></li>
<li class="chapter" data-level="5.1" data-path="tibbles-v-dataframe.html"><a href="tibbles-v-dataframe.html"><i class="fa fa-check"></i><b>5.1</b> Tibbles v. dataframe</a></li>
<li class="chapter" data-level="5.2" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>5.2</b> The pipe: <strong>%&gt;%</strong></a></li>
<li class="chapter" data-level="5.3" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html"><i class="fa fa-check"></i><b>5.3</b> The dplyr package</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#filter"><i class="fa fa-check"></i><b>5.3.1</b> filter()</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#select"><i class="fa fa-check"></i><b>5.3.2</b> select()</a></li>
<li class="chapter" data-level="5.3.3" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html#dplyr-in-action"><i class="fa fa-check"></i><b>5.3.3</b> dplyr in action</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>5.4</b> EXERCISE 1</a></li>
<li class="chapter" data-level="5.5" data-path="separate.html"><a href="separate.html"><i class="fa fa-check"></i><b>5.5</b> Separate</a></li>
<li class="chapter" data-level="5.6" data-path="resources-for-regular-expressions.html"><a href="resources-for-regular-expressions.html"><i class="fa fa-check"></i><b>5.6</b> Resources for Regular Expressions</a></li>
<li class="chapter" data-level="5.7" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>5.7</b> EXERCISE 2</a><ul>
<li class="chapter" data-level="5.7.1" data-path="exercise-2.html"><a href="exercise-2.html#merge-gene-ontologies"><i class="fa fa-check"></i><b>5.7.1</b> Merge Gene Ontologies</a></li>
<li class="chapter" data-level="5.7.2" data-path="exercise-2.html"><a href="exercise-2.html#fix-nutrient-names"><i class="fa fa-check"></i><b>5.7.2</b> Fix Nutrient names</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="break.html"><a href="break.html"><i class="fa fa-check"></i><b>5.8</b> Break</a></li>
<li class="chapter" data-level="5.9" data-path="more-fun-with-dplyr.html"><a href="more-fun-with-dplyr.html"><i class="fa fa-check"></i><b>5.9</b> More fun with dplyr</a></li>
<li class="chapter" data-level="5.10" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>5.10</b> EXERCISE 3</a><ul>
<li class="chapter" data-level="5.10.1" data-path="exercise-3.html"><a href="exercise-3.html#arrange"><i class="fa fa-check"></i><b>5.10.1</b> arrange()</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>5.11</b> EXERCISE 4</a><ul>
<li class="chapter" data-level="5.11.1" data-path="exercise-4.html"><a href="exercise-4.html#summarize"><i class="fa fa-check"></i><b>5.11.1</b> summarize()</a></li>
<li class="chapter" data-level="5.11.2" data-path="exercise-4.html"><a href="exercise-4.html#group_by"><i class="fa fa-check"></i><b>5.11.2</b> group_by()</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i><b>5.12</b> EXERCISE 5</a></li>
<li class="chapter" data-level="5.13" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i><b>5.13</b> EXERCISE 6</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="6.1" data-path="resources-to-learn-ggplot2.html"><a href="resources-to-learn-ggplot2.html"><i class="fa fa-check"></i><b>6.1</b> Resources to learn ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="make-sure-everyone-has-tidyverse-or-readr-dplyr-ggplot2.html"><a href="make-sure-everyone-has-tidyverse-or-readr-dplyr-ggplot2.html"><i class="fa fa-check"></i><b>6.2</b> Make sure everyone has tidyverse or readr, dplyr, ggplot2</a></li>
<li class="chapter" data-level="6.3" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html"><i class="fa fa-check"></i><b>6.3</b> Download data and make a new project</a><ul>
<li class="chapter" data-level="6.3.1" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html#gapminder-data"><i class="fa fa-check"></i><b>6.3.1</b> Gapminder data</a></li>
<li class="chapter" data-level="6.3.2" data-path="download-data-and-make-a-new-project.html"><a href="download-data-and-make-a-new-project.html#dplyr-review"><i class="fa fa-check"></i><b>6.3.2</b> dplyr review</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="about-ggplot2.html"><a href="about-ggplot2.html"><i class="fa fa-check"></i><b>6.4</b> About ggplot2</a></li>
<li class="chapter" data-level="6.5" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html"><i class="fa fa-check"></i><b>6.5</b> Plotting bivariate data: continuous Y by continuous X</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#adding-layers"><i class="fa fa-check"></i><b>6.5.1</b> Adding layers</a></li>
<li class="chapter" data-level="6.5.2" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#faceting"><i class="fa fa-check"></i><b>6.5.2</b> Faceting</a></li>
<li class="chapter" data-level="6.5.3" data-path="plotting-bivariate-data-continuous-y-by-continuous-x.html"><a href="plotting-bivariate-data-continuous-y-by-continuous-x.html#saving-plots"><i class="fa fa-check"></i><b>6.5.3</b> Saving plots</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plotting-bivariate-data-continuous-y-by-categorical-x.html"><a href="plotting-bivariate-data-continuous-y-by-categorical-x.html"><i class="fa fa-check"></i><b>6.6</b> Plotting bivariate data: continuous Y by categorical X</a></li>
<li class="chapter" data-level="6.7" data-path="plotting-univariate-continuous-data.html"><a href="plotting-univariate-continuous-data.html"><i class="fa fa-check"></i><b>6.7</b> Plotting univariate continuous data</a></li>
<li class="chapter" data-level="6.8" data-path="publication-ready-plots-themes.html"><a href="publication-ready-plots-themes.html"><i class="fa fa-check"></i><b>6.8</b> Publication-ready plots &amp; themes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">UVA Health Sciences Library Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-2" class="section level2">
<h2><span class="header-section-number">5.7</span> EXERCISE 2</h2>
<p>Use <code>separate</code> to create two new columns called ‘nutrient’ and ‘rate’ from the old ‘nutrientrate’ column. Think about how to separate the nutrient from the rate. Look at the help menu for <code>separate</code> by calling <code>?separate</code></p>
<pre class="sourceCode r"><code class="sourceCode r">original <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(nutrientrate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;nutrient&quot;</span>, <span class="st">&quot;rate&quot;</span>), <span class="dt">sep =</span> <span class="dv">1</span>)</code></pre>
<pre><code>## # A tibble: 199,296 x 9
##    GID   YORF  symbol systematic_name somenumber GWEIGHT nutrient rate 
##    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;                &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;
##  1 GENE… A_06… SFB2   YNL049C            1082129       1 G        0.05 
##  2 GENE… A_06… &lt;NA&gt;   YNL095C            1086222       1 G        0.05 
##  3 GENE… A_06… QRI7   YDL104C            1085955       1 G        0.05 
##  4 GENE… A_06… CFT2   YLR115W            1081958       1 G        0.05 
##  5 GENE… A_06… SSO2   YMR183C            1081214       1 G        0.05 
##  6 GENE… A_06… PSP2   YML017W            1083036       1 G        0.05 
##  7 GENE… A_06… RIB2   YOL066C            1081766       1 G        0.05 
##  8 GENE… A_06… VMA13  YPR036W            1086860       1 G        0.05 
##  9 GENE… A_06… EDC3   YEL015W            1082963       1 G        0.05 
## 10 GENE… A_06… VPS5   YOR069W            1083389       1 G        0.05 
## # … with 199,286 more rows, and 1 more variable: expression &lt;dbl&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make that change stick</span>
original &lt;-<span class="st"> </span>original <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(nutrientrate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;nutrient&quot;</span>, <span class="st">&quot;rate&quot;</span>), <span class="dt">sep =</span> <span class="dv">1</span>)</code></pre>
<p>The next thing we will do is to get rid of 4 columns we will no longer use: GID, YORF, somenumber, and GWEIGHT</p>
<pre class="sourceCode r"><code class="sourceCode r">original &lt;-<span class="st"> </span>original <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>GID, <span class="op">-</span>YORF, <span class="op">-</span>somenumber, <span class="op">-</span>GWEIGHT)

original</code></pre>
<pre><code>## # A tibble: 199,296 x 5
##    symbol systematic_name nutrient rate  expression
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt;
##  1 SFB2   YNL049C         G        0.05       -0.24
##  2 &lt;NA&gt;   YNL095C         G        0.05        0.28
##  3 QRI7   YDL104C         G        0.05       -0.02
##  4 CFT2   YLR115W         G        0.05       -0.33
##  5 SSO2   YMR183C         G        0.05        0.05
##  6 PSP2   YML017W         G        0.05       -0.69
##  7 RIB2   YOL066C         G        0.05       -0.55
##  8 VMA13  YPR036W         G        0.05       -0.75
##  9 EDC3   YEL015W         G        0.05       -0.24
## 10 VPS5   YOR069W         G        0.05       -0.16
## # … with 199,286 more rows</code></pre>
<p>A few more clean up tasks exist. We will append some gene ontologies to the dataframe, change the nutrient names to be more descriptive, change the rate into a numeric vector rather than a character, and a few other details.</p>
<div id="merge-gene-ontologies" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Merge Gene Ontologies</h3>
<p>We will use an inner join to merge the gene ontology data and the original data set. An inner join will keep instances that exist in both the left and the right dataframes</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#read in GO data</span>
sn2go &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/brauer2007_sysname2go.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   systematic_name = col_character(),
##   bp = col_character(),
##   mf = col_character()
## )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sn2go</code></pre>
<pre><code>## # A tibble: 5,536 x 3
##    systematic_name bp                     mf                               
##    &lt;chr&gt;           &lt;chr&gt;                  &lt;chr&gt;                            
##  1 YNL049C         ER to Golgi transport  molecular function unknown       
##  2 YNL095C         biological process un… molecular function unknown       
##  3 YDL104C         proteolysis and pepti… metalloendopeptidase activity    
##  4 YLR115W         mRNA polyadenylylatio… RNA binding                      
##  5 YMR183C         vesicle fusion*        t-SNARE activity                 
##  6 YML017W         biological process un… molecular function unknown       
##  7 YOL066C         riboflavin biosynthes… pseudouridylate synthase activit…
##  8 YPR036W         vacuolar acidification hydrogen-transporting ATPase act…
##  9 YEL015W         deadenylylation-indep… molecular function unknown       
## 10 YOR069W         protein retention in … protein transporter activity     
## # … with 5,526 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#inner join sn2go with original</span>
joined &lt;-<span class="st"> </span><span class="kw">inner_join</span>(original, sn2go, <span class="dt">by=</span><span class="st">&quot;systematic_name&quot;</span>)
joined</code></pre>
<pre><code>## # A tibble: 199,296 x 7
##    symbol systematic_name nutrient rate  expression bp         mf          
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       
##  1 SFB2   YNL049C         G        0.05       -0.24 ER to Gol… molecular f…
##  2 &lt;NA&gt;   YNL095C         G        0.05        0.28 biologica… molecular f…
##  3 QRI7   YDL104C         G        0.05       -0.02 proteolys… metalloendo…
##  4 CFT2   YLR115W         G        0.05       -0.33 mRNA poly… RNA binding 
##  5 SSO2   YMR183C         G        0.05        0.05 vesicle f… t-SNARE act…
##  6 PSP2   YML017W         G        0.05       -0.69 biologica… molecular f…
##  7 RIB2   YOL066C         G        0.05       -0.55 riboflavi… pseudouridy…
##  8 VMA13  YPR036W         G        0.05       -0.75 vacuolar … hydrogen-tr…
##  9 EDC3   YEL015W         G        0.05       -0.24 deadenyly… molecular f…
## 10 VPS5   YOR069W         G        0.05       -0.16 protein r… protein tra…
## # … with 199,286 more rows</code></pre>
</div>
<div id="fix-nutrient-names" class="section level3">
<h3><span class="header-section-number">5.7.2</span> Fix Nutrient names</h3>
<p>To make the nutrient names more descriptive, we will first create a dataframe that matches the nutrient character to its full name.</p>
<pre class="sourceCode r"><code class="sourceCode r">nutrient_lookup &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">nutrient =</span> <span class="kw">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;U&quot;</span>), <span class="dt">nutrient_name =</span> <span class="kw">c</span>(<span class="st">&quot;Glucose&quot;</span>, <span class="st">&quot;Leucine&quot;</span>, <span class="st">&quot;Ammonia&quot;</span>, <span class="st">&quot;Phosphate&quot;</span>, <span class="st">&quot;Sulfate&quot;</span>, <span class="st">&quot;Uracil&quot;</span>))

nutrient_lookup</code></pre>
<pre><code>## # A tibble: 6 x 2
##   nutrient nutrient_name
##   &lt;chr&gt;    &lt;chr&gt;        
## 1 G        Glucose      
## 2 L        Leucine      
## 3 N        Ammonia      
## 4 P        Phosphate    
## 5 S        Sulfate      
## 6 U        Uracil</code></pre>
<p>Now we will use left join to merge our joined dataset with the new nutrient labels.</p>
<pre class="sourceCode r"><code class="sourceCode r">joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(nutrient_lookup, <span class="dt">by =</span> <span class="st">&quot;nutrient&quot;</span>)</code></pre>
<pre><code>## # A tibble: 199,296 x 8
##    symbol systematic_name nutrient rate  expression bp    mf   
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 SFB2   YNL049C         G        0.05       -0.24 ER t… mole…
##  2 &lt;NA&gt;   YNL095C         G        0.05        0.28 biol… mole…
##  3 QRI7   YDL104C         G        0.05       -0.02 prot… meta…
##  4 CFT2   YLR115W         G        0.05       -0.33 mRNA… RNA …
##  5 SSO2   YMR183C         G        0.05        0.05 vesi… t-SN…
##  6 PSP2   YML017W         G        0.05       -0.69 biol… mole…
##  7 RIB2   YOL066C         G        0.05       -0.55 ribo… pseu…
##  8 VMA13  YPR036W         G        0.05       -0.75 vacu… hydr…
##  9 EDC3   YEL015W         G        0.05       -0.24 dead… mole…
## 10 VPS5   YOR069W         G        0.05       -0.16 prot… prot…
## # … with 199,286 more rows, and 1 more variable: nutrient_name &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make it stick</span>
joined &lt;-<span class="st"> </span>joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(nutrient_lookup, <span class="dt">by =</span> <span class="st">&quot;nutrient&quot;</span>)

joined</code></pre>
<pre><code>## # A tibble: 199,296 x 8
##    symbol systematic_name nutrient rate  expression bp    mf   
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 SFB2   YNL049C         G        0.05       -0.24 ER t… mole…
##  2 &lt;NA&gt;   YNL095C         G        0.05        0.28 biol… mole…
##  3 QRI7   YDL104C         G        0.05       -0.02 prot… meta…
##  4 CFT2   YLR115W         G        0.05       -0.33 mRNA… RNA …
##  5 SSO2   YMR183C         G        0.05        0.05 vesi… t-SN…
##  6 PSP2   YML017W         G        0.05       -0.69 biol… mole…
##  7 RIB2   YOL066C         G        0.05       -0.55 ribo… pseu…
##  8 VMA13  YPR036W         G        0.05       -0.75 vacu… hydr…
##  9 EDC3   YEL015W         G        0.05       -0.24 dead… mole…
## 10 VPS5   YOR069W         G        0.05       -0.16 prot… prot…
## # … with 199,286 more rows, and 1 more variable: nutrient_name &lt;chr&gt;</code></pre>
<p>Finally we will change rate to numeric and replace the nutrient column with the nutrient_name.</p>
<p>To create new variables or change variables in place, we are going to use dplyr’s <code>mutate()</code> function. Just like the other dplyr verbs we learned, <code>filter()</code> and <code>select()</code>, <code>mutate()</code> takes a dataframe as the first argument and then the name of the new variable followed by a function to create the new variable. Remember, these functions don’t modify the data frame you’re operating on, and the result is transient unless you assign it to a new object or reassign it back to itself (not always a good practice).</p>
<p>Let’s use <code>mutate()</code> to change rate into numeric.</p>
<pre class="sourceCode r"><code class="sourceCode r">joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.numeric</span>(rate))</code></pre>
<pre><code>## # A tibble: 199,296 x 8
##    symbol systematic_name nutrient  rate expression bp    mf   
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 SFB2   YNL049C         G         0.05      -0.24 ER t… mole…
##  2 &lt;NA&gt;   YNL095C         G         0.05       0.28 biol… mole…
##  3 QRI7   YDL104C         G         0.05      -0.02 prot… meta…
##  4 CFT2   YLR115W         G         0.05      -0.33 mRNA… RNA …
##  5 SSO2   YMR183C         G         0.05       0.05 vesi… t-SN…
##  6 PSP2   YML017W         G         0.05      -0.69 biol… mole…
##  7 RIB2   YOL066C         G         0.05      -0.55 ribo… pseu…
##  8 VMA13  YPR036W         G         0.05      -0.75 vacu… hydr…
##  9 EDC3   YEL015W         G         0.05      -0.24 dead… mole…
## 10 VPS5   YOR069W         G         0.05      -0.16 prot… prot…
## # … with 199,286 more rows, and 1 more variable: nutrient_name &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">joined</code></pre>
<pre><code>## # A tibble: 199,296 x 8
##    symbol systematic_name nutrient rate  expression bp    mf   
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 SFB2   YNL049C         G        0.05       -0.24 ER t… mole…
##  2 &lt;NA&gt;   YNL095C         G        0.05        0.28 biol… mole…
##  3 QRI7   YDL104C         G        0.05       -0.02 prot… meta…
##  4 CFT2   YLR115W         G        0.05       -0.33 mRNA… RNA …
##  5 SSO2   YMR183C         G        0.05        0.05 vesi… t-SN…
##  6 PSP2   YML017W         G        0.05       -0.69 biol… mole…
##  7 RIB2   YOL066C         G        0.05       -0.55 ribo… pseu…
##  8 VMA13  YPR036W         G        0.05       -0.75 vacu… hydr…
##  9 EDC3   YEL015W         G        0.05       -0.24 dead… mole…
## 10 VPS5   YOR069W         G        0.05       -0.16 prot… prot…
## # … with 199,286 more rows, and 1 more variable: nutrient_name &lt;chr&gt;</code></pre>
<p>Notice that in the symbol, there are NAs but they are formatted just like the other gene symbols. We will use a common structure calling <code>ifelse()</code> within the mutate function to recode the NAs as missings</p>
<pre class="sourceCode r"><code class="sourceCode r">joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.numeric</span>(rate))  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">symbol =</span> <span class="kw">ifelse</span>(symbol <span class="op">==</span><span class="st"> &quot;NA&quot;</span>, <span class="ot">NA</span>, symbol))</code></pre>
<pre><code>## # A tibble: 199,296 x 8
##    symbol systematic_name nutrient  rate expression bp    mf   
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 SFB2   YNL049C         G         0.05      -0.24 ER t… mole…
##  2 &lt;NA&gt;   YNL095C         G         0.05       0.28 biol… mole…
##  3 QRI7   YDL104C         G         0.05      -0.02 prot… meta…
##  4 CFT2   YLR115W         G         0.05      -0.33 mRNA… RNA …
##  5 SSO2   YMR183C         G         0.05       0.05 vesi… t-SN…
##  6 PSP2   YML017W         G         0.05      -0.69 biol… mole…
##  7 RIB2   YOL066C         G         0.05      -0.55 ribo… pseu…
##  8 VMA13  YPR036W         G         0.05      -0.75 vacu… hydr…
##  9 EDC3   YEL015W         G         0.05      -0.24 dead… mole…
## 10 VPS5   YOR069W         G         0.05      -0.16 prot… prot…
## # … with 199,286 more rows, and 1 more variable: nutrient_name &lt;chr&gt;</code></pre>
<p>Next, we will use select to remove the nutrient column and then a second call to select to move the nutrient name column into the place and variable name nutrient</p>
<pre class="sourceCode r"><code class="sourceCode r">joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.numeric</span>(rate))  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">symbol =</span> <span class="kw">ifelse</span>(symbol <span class="op">==</span><span class="st"> &quot;NA&quot;</span>, <span class="ot">NA</span>, symbol)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>nutrient) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(symbol, systematic_name, <span class="dt">nutrient =</span> nutrient_name, rate<span class="op">:</span>mf)</code></pre>
<pre><code>## # A tibble: 199,296 x 7
##    symbol systematic_name nutrient  rate expression bp         mf          
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       
##  1 SFB2   YNL049C         Glucose   0.05      -0.24 ER to Gol… molecular f…
##  2 &lt;NA&gt;   YNL095C         Glucose   0.05       0.28 biologica… molecular f…
##  3 QRI7   YDL104C         Glucose   0.05      -0.02 proteolys… metalloendo…
##  4 CFT2   YLR115W         Glucose   0.05      -0.33 mRNA poly… RNA binding 
##  5 SSO2   YMR183C         Glucose   0.05       0.05 vesicle f… t-SNARE act…
##  6 PSP2   YML017W         Glucose   0.05      -0.69 biologica… molecular f…
##  7 RIB2   YOL066C         Glucose   0.05      -0.55 riboflavi… pseudouridy…
##  8 VMA13  YPR036W         Glucose   0.05      -0.75 vacuolar … hydrogen-tr…
##  9 EDC3   YEL015W         Glucose   0.05      -0.24 deadenyly… molecular f…
## 10 VPS5   YOR069W         Glucose   0.05      -0.16 protein r… protein tra…
## # … with 199,286 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make it stick</span>
joined &lt;-<span class="st"> </span>joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.numeric</span>(rate)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">symbol =</span> <span class="kw">ifelse</span>(symbol <span class="op">==</span><span class="st"> &quot;NA&quot;</span>, <span class="ot">NA</span>, symbol)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>nutrient) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(symbol<span class="op">:</span>systematic_name, <span class="dt">nutrient =</span> nutrient_name, rate<span class="op">:</span>mf)</code></pre>
<p>Our last tidying step will be to remove cases where gene expression was missing.</p>
<pre class="sourceCode r"><code class="sourceCode r">joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(expression))</code></pre>
<pre><code>## # A tibble: 198,430 x 7
##    symbol systematic_name nutrient  rate expression bp         mf          
##    &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       
##  1 SFB2   YNL049C         Glucose   0.05      -0.24 ER to Gol… molecular f…
##  2 &lt;NA&gt;   YNL095C         Glucose   0.05       0.28 biologica… molecular f…
##  3 QRI7   YDL104C         Glucose   0.05      -0.02 proteolys… metalloendo…
##  4 CFT2   YLR115W         Glucose   0.05      -0.33 mRNA poly… RNA binding 
##  5 SSO2   YMR183C         Glucose   0.05       0.05 vesicle f… t-SNARE act…
##  6 PSP2   YML017W         Glucose   0.05      -0.69 biologica… molecular f…
##  7 RIB2   YOL066C         Glucose   0.05      -0.55 riboflavi… pseudouridy…
##  8 VMA13  YPR036W         Glucose   0.05      -0.75 vacuolar … hydrogen-tr…
##  9 EDC3   YEL015W         Glucose   0.05      -0.24 deadenyly… molecular f…
## 10 VPS5   YOR069W         Glucose   0.05      -0.16 protein r… protein tra…
## # … with 198,420 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">clean &lt;-<span class="st"> </span>joined <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(expression))

<span class="co"># Read in brauer2007_tidy.csv as &quot;clean&quot; if you got lost</span>
clean &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/brauer2007_tidy.csv&quot;</span>)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   symbol = col_character(),
##   systematic_name = col_character(),
##   nutrient = col_character(),
##   rate = col_double(),
##   expression = col_double(),
##   bp = col_character(),
##   mf = col_character()
## )</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="resources-for-regular-expressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="break.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
